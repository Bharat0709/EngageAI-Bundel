(()=>{const t={};async function e(t){const e=await async function(){const t=document.cookie.split("; ").find((t=>t.startsWith("JSESSIONID=")));return t?t.split("=").pop().replace(/['"]+/g,""):null}(),o=`https://www.linkedin.com/voyager/api/${t}`,n={"Content-Type":"application/json",...e&&{"Csrf-token":e}};try{const t=await fetch(o,{credentials:"include",method:"GET",headers:n});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return{success:!0,data:await t.json()}}catch(t){return{success:!1,error:t.message}}}chrome.runtime.onMessage.addListener((function(i,r,c){"fetchAnalytics"===i.action&&async function(){await async function(){const s=await e("identity/profiles/me");if(!s.success)throw new Error(s.error);t.firstName=s.data.firstName,t.lastName=s.data.lastName;const a=s.data.entityUrn.split(":")[3];if(!a)throw new Error("Public identifier not found");const i=Date.now().toString();n(o.LAST_FETCHED_PROFILE_TIMESTAMP,i),n(o.LAST_FETCHED_POSTS_TIMESTAMP,i),n(o.LAST_FETCHED_STATISTICS_TIMESTAMP,i),n(o.PUBLIC_IDENTIFIER,a)}(),await async function(){const s=await e("identity/profiles/me/networkinfo?shouldIncludeFollowingCount=true");if(!s.success)throw new Error(s.error);const a=await e("identity/profiles/me/dashboard");if(!a.success)throw new Error(a.error);const i=await e("relationships/connectionsSummary");if(!i.success)throw new Error(i.error);t.connectionsCount=i.data.numConnections,t.profileViews=a.data.numProfileViews,t.followersCount=s.data.followersCount,t.followingCount=s.data.followingInfo.followingCount,t.searchAppearances=a.data.numSearchAppearances,t.completedAspects=a.data.profileCompletionMeter?.profileCompletionStatus.completedAspects,t.stepsToCompleteProfile=a.data.profileCompletionMeter?.stepsToCompleteProfile,t.missingAspects=a.data.profileCompletionMeter?.profileCompletionStatus.missingAspects,t.memberId="6761e5cc30ab114a111941f6",t.OrganizationId="67619649e9dade7164a38de0",n(o.LAST_FETCHED_STATISTICS_TIMESTAMP,Date.now().toString())}(),await async function(){const t=function(t){const e=localStorage.getItem(t);if(null===e)throw new Error(`Item for key '${t}' not found in local storage.`);return e}(o.PUBLIC_IDENTIFIER),i=await e(`identity/profileUpdatesV2?count=100&includeLongTermHistory=true&moduleKey=member-shares%3Aphone&numComments=10&numLikes=10&profileUrn=urn%3Ali%3Afsd_profile%3A${t}&q=memberShareFeed`);if(i?.data?.elements){if(i.data.elements.forEach((t=>{const e=a(t);s.push(e)})),!i.success)throw new Error(i.error);return n(o.LAST_FETCHED_POSTS_TIMESTAMP,Date.now().toString()),s}console.error("No posts found.")}();const i=document.getElementById("reloadText"),r=document.getElementById("lastSynced");let c=!1,l=!1;setTimeout((()=>{i&&(i.textContent="Syncing posts data....")}),4e3),i.textContent="Syncing profile data....",chrome.runtime.sendMessage({action:"updatePostsAnalyticsData",data:s},(function(t){t&&t.success?(s=[],l=!0):(s=[],console.error("Error updating Posts analytics data"))})),chrome.runtime.sendMessage({action:"updateAnalyticsData",data:t},(function(t){t&&t.success?c=!0:console.error("Error updating analytics data")})),setTimeout((()=>{l&&c?(r&&(r.textContent=`Last Synced at ${function(t){const[e,o]=t.split(", "),[n,s,a]=e.split("/").map(Number),i=n%10==1&&11!==n?"st":n%10==2&&12!==n?"nd":n%10==3&&13!==n?"rd":"th",[r,c]=o.split(":"),l=r<12||"24"===r?"AM":"PM",u=r%12||12;return`${n}${i} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s-1]}, ${a.toString().slice(2)} at ${u}:${c} ${l}`}((new Date).toLocaleString("en-GB"))}`),i&&(i.textContent="Synced")):i&&(i.textContent="Error Syncing Account")}),1e4)}()}));const o={LAST_FETCHED_POSTS_TIMESTAMP:"lfPostsTimestamp",LAST_FETCHED_PROFILE_TIMESTAMP:"lfProfileTimestamp",LAST_FETCHED_STATISTICS_TIMESTAMP:"lfStatisticsTimestamp",PUBLIC_IDENTIFIER:"publicIdentifier"};function n(t,e){localStorage.setItem(t,e)}let s=[];const a=t=>({postedAround:t.actor.subDescription.accessibilityText,author:t.actor.name.text,shareUrl:t.socialContent.shareUrl,numLikes:t.socialDetail?.totalSocialActivityCounts?.numLikes||0,numShares:t.socialDetail?.totalSocialActivityCounts?.numShares||0,numViews:t.socialDetail?.totalSocialActivityCounts?.numViews||0,numImpressions:t.socialDetail?.totalSocialActivityCounts?.numImpressions||0,numComments:t.socialDetail?.totalSocialActivityCounts?.numComments||0,textContent:t.commentary.text.text,postUrn:t.updateMetadata.urn})})();