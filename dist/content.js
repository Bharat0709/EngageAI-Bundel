(()=>{function e(e){let t=e.querySelector(".display-flex.mlA");null===t&&(t=e.querySelector(".display-flex.justify-space-between")),t.style.display="flex",t.style.alignItems="center";const n=document.createElement("img");n.id="stop-button",n.src="https://pic.onlinewebfonts.com/thumbnails/icons_182193.svg",t&&t.insertAdjacentElement("afterBegin",n)}function t(e,t,n){let o=n.querySelector(".display-flex.mlA");null===o&&(o=n.querySelector(".display-flex.justify-space-between"));const r=document.createElement("button");r.id="regenerate-button",r.textContent="Regenerate",n.querySelector("#remove-comment-options"),o&&!e&&o.insertAdjacentElement("afterBegin",r),t&&t.remove()}function n(e,n,o){const r=o.querySelector("#regenerate-button"),a=o.querySelector("#stop-button");var i,c=e.split(""),s=0;!function e(){s<c.length?(n.textContent+=c[s],s++,i=setTimeout(e,20)):s===c.length&&(a&&a.remove(),t(r,a,o))}(),a.addEventListener("click",(function(){clearTimeout(i),t(r,a,o)}))}function o(){const e=document.querySelector("#post-regenerate-button"),t=document.querySelector("#readd-postoptions");e&&e.remove(),t&&t.remove();const n=document.querySelector(".share-box"),a=n.querySelector(".share-creation-state__text-editor.share-creation-state__text-editor-redesigned"),i=n.querySelector(".artdeco-carousel__content");if(a){const e=n.querySelector(".ql-editor");e.blur(),e.textContent="",e.setAttribute("data-placeholder"," "),e.setAttribute("aria-placeholder"," ");const t=a.parentElement.querySelector("#generatePostButton"),c=a.parentElement.querySelector("#postTyzpeInput"),s=a.parentElement.querySelector("#AIpostoptions"),l=a.parentElement.querySelector("#postToneDropdown");if(!(t||c||s||l)){a.style.minHeight="0rem";const e=document.createElement("div"),t=document.createElement("div"),c=document.createElement("textarea"),s=document.createElement("select"),l=document.createElement("select"),d=document.createElement("button"),m=document.createElement("img");c.id="postTypeInput",s.id="postToneDropdown",d.id="generatePostButton",l.id="AIpostoptions",t.id="dropdowndiv",e.id="post-containerDiv",m.id="remove-post-options",m.src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-close-1024.png",m.alt="remove-post-options",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="flex-start",i.prepend(m),m.addEventListener("click",r),d.textContent="Generate Post",c.placeholder="Briefly describe about the topic of the post";const u=["gemini","chatgpt"];["friendly","funny","short","formal","announcement","serious","position Update","experience"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),s.appendChild(t)})),u.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),l.appendChild(t)})),t.appendChild(s),t.appendChild(l),e.appendChild(c),e.appendChild(t),e.appendChild(d),a.parentElement.appendChild(e),d.addEventListener("click",(async()=>{if(""===c.value||null===c.value)return void alert("Please enter the description for the post");const t=c.value.trim(),r=s.value.trim(),a=l.value;e.textContent="",d&&d.remove();const i=e.querySelector("#commentOptions");i&&i.remove();const m=e.querySelector("#postToneDropdown");m&&m.remove(),await async function(e,t,n,r,a){const i=document.createElement("button");i.textContent="Regenerate",i.id="post-regenerate-button";const c=a.querySelector("#remove-post-options");c&&c.remove();const s=a.querySelector(".ql-editor"),l=a.querySelector(".artdeco-carousel__heading");l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="flex-start";const d=document.createElement("div");d.style.color="#000",d.textContent="Analysing Your Requirements...",d.classList.add("comment-message"),d.classList.add("comment-message-blink");const m=document.createElement("style");m.textContent="\n  .comment-message {\n    animation: blink-animation 1.5s infinite;\n  }\n\n  @keyframes blink-animation {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0;\n    }\n  }\n  ",document.head.appendChild(m),r.appendChild(d),d.textContent="Generating Post Content...";const u=(await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))}))).jwtToken;if(!u)return void(d.textContent="User not authenticated, Reload and try again!!");const p=`https://linkedai.onrender.com/api/v1/ai/generate${n}postcontent`;try{const n=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${u}`},body:JSON.stringify({postType:e,selectedTone:t})});403===n.status&&alert("Credits Exhausted!");const r=(await n.json()).generatedPostContent,a=document.querySelector(".editor-content.ql-container");d.remove(),a.querySelector(".ql-editor p").textContent=r,s.focus(),l.prepend(i),i.addEventListener("click",o)}catch(e){d.textContent=e}}(t,r,a,e,n)}))}}}function r(){const e=document.querySelector(".share-creation-state__text-editor.share-creation-state__text-editor-redesigned"),t=e.parentElement.querySelector(".ql-editor"),n=e.parentElement.querySelector("#generatePostButton"),r=e.parentElement.querySelector("#post-regenerate-button"),a=document.querySelector(".artdeco-carousel__content"),i=document.querySelector("#remove-post-options"),c=e.parentElement.querySelector("#postTypeInput"),s=e.parentElement.querySelector("#AIpostoptions"),l=e.parentElement.querySelector("#postToneDropdown");n&&n.remove(),c&&c.remove(),s&&s.remove(),l&&l.remove(),r&&r.remove(),i&&i.remove(),t&&t.focus(),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="flex-start";const d=document.createElement("button");d.textContent="Write with AI",d.id="readd-postoptions",d.addEventListener("click",o),a.prepend(d)}function a(){const e=document.querySelector("#message-options"),t=document.querySelector("#new-conversation-options-div"),n=document.querySelector("#remove-new-conversation-options"),o=localStorage.getItem("name");if(t&&t.remove(),n&&n.remove(),!e){const e=document.createElement("div");e.id="message-options";const t=document.createElement("button");t.textContent="Generate Reply",t.id="generate-message-reply",t.addEventListener("click",(function(){const e=document.querySelector(".msg-form__contenteditable"),t=function(){const e=document.querySelector(".msg-s-message-list-content").querySelectorAll(".msg-s-message-list__event");let t=[];if(e&&0!==e.length){for(let n=Math.max(e.length-5,0);n<e.length;n++){const o=e[n],r=o.querySelector(".msg-s-message-group__name")?.textContent.trim(),a=o.querySelector(".msg-s-event-listitem__body")?.textContent.trim(),i=n===e.length-1?"Unknown":e[n+1].querySelector(".msg-s-message-group__name")?.textContent.trim();r&&a&&t.push({sender:r,message:a,receiver:i})}return t.reverse()}alert("No conversation found.")}();0===t.length&&alert("No conversation found."),async function(e,t,n){e.innerHTML="",e.setAttribute("aria-label","");const o=document.querySelector(".msg-form__placeholder");o&&o.setAttribute("data-placeholder","");const r=document.createElement("style");r.textContent="\n  .template-message {\n    animation: blink-animation 1.5s infinite;\n  }\n\n  @keyframes blink-animation {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0;\n    }\n  }\n",document.head.appendChild(r);const a=document.createElement("div");a.style.color="#000",a.textContent="Reading Conversation...",a.classList.add("template-message"),a.classList.add("template-message-blink"),e.appendChild(a);const i=(await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))}))).jwtToken;if(!i)return a.textContent="User not Authenticated! Move to feed, Reload and try again",sendResponse({authenticated:!1});try{const o=await fetch("https://linkedai.onrender.com/api/v1/ai/generatechatgptreply",{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${i}`},body:JSON.stringify({formattedMessages:t,userName:n})});if(403===o.status)return a.textContent="Credits Exhausted!",void alert("Credits Exhausted!!");const r=(await o.json()).generatedReply,d=document.createElement("p");e.appendChild(d),a.remove(),r?(a.remove(),e.style.whiteSpace="pre-line",c=d,s=r.split(""),l=0,function e(){l<s.length?(c.textContent+=s[l],l++,animationTimeout=setTimeout(e,20)):s.length}()):a.textContent="Error Generating Reply! Reload and try again"}catch(e){a.textContent=e}var c,s,l}(e,t.map((e=>`${e.sender} : ${e.message}`)).join("\n"),o)}));const n=document.createElement("button");n.textContent="New Conversation",n.id="start-new-conversation",e.appendChild(t),e.appendChild(n);const r=document.querySelector(".msg-form__msg-content-container");r.insertAdjacentElement("afterend",e),n.addEventListener("click",(function(){e.remove();const t=i();r.insertAdjacentElement("afterend",t)}))}}function i(){const e=document.querySelector("#remove-new-conversation-options");e&&e.remove();const t=document.querySelector(".msg-form__placeholder");t&&t.setAttribute("data-placeholder","");const n=document.createElement("div"),o=document.createElement("select"),r=document.createElement("select"),c=document.createElement("button"),s=document.createElement("img"),l=document.createElement("button");l.id="regenerate-messsage-button",s.id="remove-new-conversation-options",s.src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-close-1024.png",s.classList.add("remove-options-button"),n.id="new-conversation-options-div",o.id="templateRequirements",r.id="templateToneDropdown",c.id="generateTemplateButton",c.textContent="Generate",l.textContent="Regenerate",["Referral Request","Job Application","General Networking","Informational Meeting Request","Business Collaboration","Mentorship Request","Feedback or Advice Request"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),o.appendChild(t)})),["professional","friendly","Formal","Funny","Creative"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),r.appendChild(t)}));const d=document.querySelector(".msg-form__left-actions");return d.style.alignItems="center",d.appendChild(s),n.appendChild(o),n.appendChild(r),n.appendChild(c),s.addEventListener("click",(function(){a()})),c.addEventListener("click",(async()=>{const e=o.value.trim(),t=r.value.trim(),a=document.querySelector(".msg-form__contenteditable");s.classList.add("rotate-animation"),o.remove(),r.remove(),c.remove(),await async function(e,t,n,o,r){n.innerHTML="",n.setAttribute("aria-label","");const a=document.querySelector(".msg-form__placeholder");a&&a.setAttribute("data-placeholder","");const i=document.createElement("style");i.textContent="\n  .template-message {\n    animation: blink-animation 1.5s infinite;\n  }\n\n  @keyframes blink-animation {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0;\n    }\n  }\n",document.head.appendChild(i);const c=document.createElement("div");c.style.color="#000",c.textContent="Analysing Your Requirements...",c.classList.add("template-message"),c.classList.add("template-message-blink"),n.appendChild(c),c.textContent="Generating Template...";const s=(await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))}))).jwtToken;if(!s)return c.textContent="User not Authenticated! Move to feed, Reload and try again",sendResponse({authenticated:!1});try{const a=await fetch("https://linkedai.onrender.com/api/v1/ai/generatechatgpttemplate",{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${s}`},body:JSON.stringify({templateRequirements:e,selectedTone:t})});if(403===a.status)return c.textContent="Credits Exhausted!",void alert("Insufficient Credits!!");const i=(await a.json()).generatedTemplateContent,l=document.createElement("p");n.appendChild(l),c.remove(),i?(c.remove(),n.style.whiteSpace="pre-line",function(e,t,n,o){var r=e.split(""),a=0;!function e(){a<r.length?(t.textContent+=r[a],a++,animationTimeout=setTimeout(e,20)):a===r.length&&n.appendChild(o)}()}(i,l,o,r)):c.textContent="Error Generating Message Template!! Reload and try again"}catch(e){c.textContent=e}}(e,t,a,n,l)})),l.addEventListener("click",(function(){l.remove();const e=document.querySelector(".msg-form__msg-content-container"),t=i();e.insertAdjacentElement("afterend",t)})),n}chrome.runtime.onMessage.addListener((function(e,t,n){"checkLinkedInUrl"===e.action&&n({isLinkedIn:window.location.href.includes("linkedin.com")})})),chrome.runtime.onMessage.addListener((function(e,t,n){"callAddDashboardFunction"===e.action&&a()})),chrome.runtime.onMessage.addListener((function(e,t,n){"checkLinkedInFeedUrl"===e.action&&n({isLinkedInFeed:isLinkedInFeeedUrl(window.location.href)})})),document.addEventListener("click",(function(t){const o=t.target;if(o.classList.contains("comments-comment-box__submit-button")||o.classList.contains("artdeco-button__text")){const e=o.closest(".feed-shared-update-v2.feed-shared-update-v2--minimal-padding.full-height.relative").querySelector("#regenerate-button");e&&e.remove()}(o.classList.contains("comment-button")||o.closest("button.comment-button")||o.id.includes("regenerate-button"))&&function(t){const o=t.closest(".feed-shared-update-v2.feed-shared-update-v2--minimal-padding.full-height.relative");if(o){const a=o.querySelector(".comments-comment-box-comment__text-editor"),i=o.querySelector(".ql-editor"),c=o.querySelector(".update-components-text span.break-words");let s=o.querySelector(".display-flex.mlA");null===s&&(s=o.querySelector(".display-flex.justify-space-between"));const l=o.querySelector("#custom-tone-input"),d=o.querySelector("#word-count-input"),m=a.querySelector("#generateButton"),u=a.querySelector("#AIoptions"),p=a.querySelector("#commentOptions"),y=o.querySelector("#stop-button"),g=o.querySelector("#regenerate-button");if(!(l||d||y||m||p||u)){g&&g.remove();const h=document.createElement("button"),f=document.createElement("select"),v=document.createElement("select"),C=document.createElement("img");C.id="remove-comment-options",f.id="commentOptions",v.id="AIoptions",h.id="generateButton",C.src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-close-1024.png",C.alt="remove-options",v.style.width="140px",f.style.width="120px",t.id.includes("regenerate-button")?h.textContent="Regenerate":h.textContent="Generate",["friendly","funny","disagree","congratulate","question","custom"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),f.appendChild(t)})),["gemini","chatgpt"].forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),v.appendChild(t)}));let S=o.querySelector(".display-flex.mlA");if(null===S&&(S=o.querySelector(".display-flex.justify-space-between")),S.style.display="flex",S.style.justifyContent="space-around",s.style.margin="0px 8px 0px 8px",S.style.alignItems="center",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="flex-start",o.style.alignItems="center",!y){i.textContent=" ",i.setAttribute("data-placeholder"," "),i.setAttribute("aria-placeholder"," "),a.appendChild(v),a.appendChild(f),a.appendChild(h),s.prepend(C);const q=o.querySelector(".ql-editor");function r(){const r=localStorage.getItem("isCommentGenerating"),i=c;if("false"===r&&i){const r=f.value,c=v.value,s=o.querySelector("#remove-comment-options"),l=i.textContent.trim();a.removeChild(f),a.removeChild(v),a.removeChild(h),s.remove(),e(o),localStorage.setItem("isCommentGenerating",!0),async function(e,t,o,r,a,i){const c=await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))})),s=document.createElement("div");o.appendChild(s);const l=c.jwtToken;if(!l)return void(s.textContent="User not authenticated reload and try again!!");document.querySelector(".ql-editor").textContent=" ",s.id="processing-message",i.id?.includes("regenerate-button")?s.textContent="Regenerating Comment...":s.textContent="Generating Comment...";const d=`https://linkedai.onrender.com/api/v1/ai/generate${a}comment`;try{const a=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({postContent:t,selectedOption:r})});if(405===a.status)return void alert("Comment Generation in progress please wait");403===a.status&&(s.textContent="Credits Exhausted!"),a.ok||403==a.status||(s.textContent="Something went wrong, please reload and try again!!");const i=(await a.json()).generatedComment,c=o.querySelector(".ql-editor p");i&&(s.remove(),n(i,c,e)),localStorage.setItem("isCommentGenerating",!1)}catch(e){localStorage.setItem("isCommentGenerating",!1),s.textContent="Something went wrong, please reload and try again!!"}}(o,l,a,r,c,t)}"true"===r&&alert("Comment Generation in Progress Please Wait")}q&&q.blur(),h.addEventListener("click",r),C.addEventListener("click",(function(){const e=o.querySelector("#generateButton"),t=o.querySelector("#commentOptions"),n=o.querySelector("#AIoptions"),r=o.querySelector("#word-count-input"),a=o.querySelector("#custom-tone-input"),i=o.querySelector("#remove-comment-options");i&&i.remove(),e&&e.remove(),t&&t.remove(),n&&n.remove(),r&&r.remove(),a&&a.remove();const c=o.querySelector(".ql-editor");c&&c.focus()})),f.addEventListener("change",(function(){if("custom"===f.value){v&&f.remove();const i=v.value;if(!l&&!d){const s=document.createElement("input"),l=document.createElement("input");l.id="word-count-input",s.id="custom-tone-input",l.type="number",l.placeholder="Word Count",s.placeholder="Custom Tone",a.insertBefore(l,a.firstChild),a.insertBefore(s,a.firstChild),h.style.margin="4px 4px 4px 4px",a.style.flexWrap="wrap",l.style.width="120px",v.style.width="100px",s.style.width="170px",h.removeEventListener("click",r),h.addEventListener("click",(async()=>{C&&C.remove();const r=c,d=localStorage.getItem("isCommentGenerating");if("true"===d&&alert("Comment Generation in Progress Please Wait"),"false"===d&&r){const c=s.value,d=l.value;if(!c)return void alert("Please specify the tone for the comment");if(!d)return void alert("Please specify the word count");const m=r.textContent.trim();a.removeChild(s),a.removeChild(l),a.removeChild(h),a.removeChild(v),e(o),localStorage.setItem("isCommentGenerating",!0),await async function(e,t,o,r,a,i,c){const s=await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))})),l=document.createElement("div");o.appendChild(l);const d=s.jwtToken;if(!d)return void(l.textContent="User not authenticated reload and try again!!");document.querySelector(".ql-editor").textContent=" ",l.id="processing-message",r.id.includes("regenerate-button")?l.textContent="Regenerating Comment...":l.textContent="Generating Comment...";const m=`https://linkedai.onrender.com/api/v1/ai/generatecustom${a}comment`;try{const r=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${d}`},body:JSON.stringify({postContent:t,customTone:i,wordCount:c})});403===r.status&&(l.textContent="Credits Exhausted!"),r.ok||403==r.status||(l.textContent="Something went wrong, please reload and try again.");const a=(await r.json()).generatedComment,s=o.querySelector(".ql-editor p");l.remove(),n(a,s,e),localStorage.setItem("isCommentGenerating",!1)}catch(e){localStorage.setItem("isCommentGenerating",!1),l.textContent="Something went wrong, please reload and try again."}}(o,m,a,t,i,c,d)}}))}}}))}}}}(o),o.closest(".share-box-feed-entry__top-bar")&&setTimeout((function(){r()}),3e3);const i=document.querySelector(".global-nav__primary-link"),c=document.querySelector(".msg-overlay-list-bubble__convo-card-container");(o===i||o===c||o.closest(".msg-conversation-card__content--selectable")||o.closest(".global-nav__primary-link"))&&setTimeout((function(){a()}),3e3)})),localStorage.setItem("isCommentGenerating",!1),chrome.runtime.onMessage.addListener((function(e,t,n){if("checkForElement"===e.action){const e=document.querySelector(".ember-view.block"),t=e.querySelector(".t-16.t-black.t-bold");if(e&&t){const e=t.textContent.trim();chrome.runtime.sendMessage({action:"elementFound",element:e})}else chrome.runtime.sendMessage({action:"elementNotFound"})}})),chrome.runtime.onMessage.addListener((function(e,t,n){if("loggedoutAlert"===e.action){alert("Logged Out Successfully");const e=document.querySelectorAll(".comments-comment-box-comment__text-editor"),t=document.querySelector(".share-creation-state__text-editor .editor-content .ql-editor"),n=document.querySelector(".msg-form__contenteditable");e&&document.querySelectorAll(".comments-comment-box-comment__text-editor").forEach((e=>{const t=e.querySelector("#generateButton"),n=e.querySelector("#commentOptions"),o=e.querySelector("#AIoptions"),r=e.querySelector("#word-count-input"),a=e.querySelector("#custom-tone-input"),i=e.querySelector("#remove-comment-options");i&&i.remove(),t&&t.remove(),n&&n.remove(),o&&o.remove(),r&&r.remove(),a&&a.remove()})),t&&removePostOptions(),n&&function(){const e=document.querySelector(".msg-form__contenteditable"),t=e.querySelector("#generateTemplateButton"),n=e.querySelector("#templateRequirements"),o=e.querySelector("#templateToneDropdown");t&&t.remove(),n&&n.remove(),o&&o.remove()}()}}))})();