(()=>{function e(){const e=document.querySelector(".feed-identity-module__actor-meta.break-words");if(e){const n=e.querySelector("a.ember-view").href.trim(),o=e.querySelector(".t-16.t-black.t-bold").textContent.trim(),a=document.querySelector('[role="region"][aria-label="Side Bar"]');if(localStorage.setItem("name",o),a){const d=document.createElement("div");d.textContent="Welcome to EngageGPT Checking Server Status....",d.id="server-status",a.parentNode.insertBefore(d,a),chrome.runtime.sendMessage({action:"checkserver"},(function(a){a&&a.awake?(d.textContent="Welcome to EngageGPT!",t(o,n,d,e)):(d.textContent="Welcome to EngageGPT, Server is down. Please visit again after some time.",d.style.backgroundColor="red",d.style.color="white")}))}}else if(!e||null===e){const e=document.querySelector(".artdeco-card.pb4.mb2.overflow-hidden");if(e){const n=e.querySelector(".ember-view.link-without-hover-visited.display-flex.flex-column.mb2").href.trim(),o=e.querySelector(".profile-card-name.text-heading-large.mt1").textContent.trim(),a=document.querySelector('[role="region"][aria-label="Side Bar"]');if(localStorage.setItem("name",o),a){const d=document.createElement("div");d.textContent="Welcome to EngageGPT Checking Server Status....",d.id="server-status",a.parentNode.insertBefore(d,a),chrome.runtime.sendMessage({action:"checkserver"},(function(a){a&&a.awake?(d.textContent="Welcome to EngageGPT!",t(o,n,d,e)):(d.textContent="Welcome to EngageGPT, Server is down. Please visit again after some time.",d.style.backgroundColor="red",d.style.color="white")}))}}}}async function t(e,t,d,i){const l=(await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))}))).jwtToken;l?chrome.runtime.sendMessage({action:"checkAuthentication"},(function(e){if(e&&e.authenticated){const t=document.getElementById("server-status");n(e.data.user,i),a(e.data.user),o(),0===e.data.user.credits&&(t.textContent="Credits Exhausted",t.style.backgroundColor="red")}else d.textContent="User Not Found!",d.style.backgroundColor="red",localStorage.clear(),chrome.runtime.sendMessage({action:"logoutUser"},(async function(e){e.loggedOut?alert("Reload and try again!!"):!1===e.loggedOut&&alert("Failed to logout")}))})):l&&void 0!==l||chrome.runtime.sendMessage({action:"checkEmailExists",name:e,profileLink:t},(async function(d){if(d&&d.success){const e=document.getElementById("server-status"),t=d.data.token;await chrome.storage.local.set({jwtToken:t}),n(d.data.user,i),a(d.data.user),o(),0===d.data.user.credits&&(e.textContent="Credits Exhausted",e.style.backgroundColor="red")}else{const d=document.querySelector('[role="region"][aria-label="Side Bar"]'),l=document.createElement("p"),r=document.createElement("div");r.id="verify-email-div",l.textContent=`Hii, ${e}`,l.id="temp-user-name";const c=document.createElement("input"),s=document.createElement("p");s.id="getStarted",s.textContent="Verify your email to get started";const u=document.createElement("button"),m=document.createElement("div");m.appendChild(l),m.appendChild(s),r.appendChild(c),r.appendChild(u),m.appendChild(r),m.id="emailDiv",c.type="email",c.placeholder="Email",c.required=!0,c.id="email",u.id="addemailButton",u.textContent="Verify",d.parentNode.insertBefore(m,d),u.addEventListener("click",(function(){const d=document.createElement("div");d.id="otpDiv";const l=document.createElement("input");l.id="otpInput",l.placeholder="Enter OTP",l.type="text";const p=document.createElement("button");p.id="verifyOtpButton",p.textContent="Verify OTP";const h=document.createElement("p");h.textContent="Resend",h.id="no-otp";const y=document.createElement("div");y.id="no-otp-div";const C=document.createElement("p");C.textContent="Didn't receive OTP?",C.id="no-otp-note",d.appendChild(l),d.appendChild(p),y.appendChild(C),y.appendChild(h);const g=c.value.trim();if(g){if(!g.endsWith("@gmail.com"))return alert("Currently Gmail addresses are supported."),void(c.value="");u.textContent="Verifying",u.disabled=!0,u.style.cursor="not-allowed",u.style.opacity="0.6",u.style.marginLeft="2px",chrome.runtime.sendMessage({action:"sendOTP",email:g},(async function(e){if(e&&e.success){c.remove(),u.remove(),m.appendChild(d),m.appendChild(y),alert("OTP sent successfully (Check spam folder also)");let e=60;const t=setInterval((()=>{C.textContent=`Resend in ${e} secs`,h.disabled=!0,h.removeEventListener("click",f),h.style.cursor="not-allowed",h.style.opacity="0.6",e--,e<0&&(clearInterval(t),h.disabled=!1,h.addEventListener("click",f),h.style.cursor="pointer",h.style.opacity="1",u.disabled=!1)}),1e3)}else e&&e.tooManyRequests?(u.textContent="Verify",u.style.marginLeft="",u.disabled=!1,u.style.cursor="pointer",u.style.opacity="1",alert("Too many requests, Try again after some time")):(u.textContent="Verify",u.style.marginLeft="",u.disabled=!1,u.style.cursor="pointer",u.style.opacity="1",alert("Failed to send OTP. Please try again."))})),p.addEventListener("click",(async function(){const d=l.value.trim();d?(p.disabled=!0,p.style.cursor="not-allowed",p.style.opacity="0.6",p.textContent="Verifying...",chrome.runtime.sendMessage({action:"addToGuestUser",otp:d,name:e,profileLink:t,email:g},(async function(e){if(e&&e.success){l.remove(),s.remove(),p.remove(),m.remove(),n(e.data.user,i),a(e.data.user),o();const t=e.data.token;await chrome.storage.local.set({jwtToken:t}),alert("Email added successfully"),alert("Watch feature tutorials to get started")}else e&&e.invalidOTP?(p.disabled=!1,p.style.cursor="pointer",p.style.opacity="1",l.value="",p.textContent="Verify OTP",alert("Invalid OTP")):e&&e.alreadyExists?(p.disabled=!1,l.value="",p.style.cursor="pointer",p.style.opacity="1",p.textContent="Verify OTP",alert("Email already exists")):e&&e.internalServerError?(p.disabled=!1,l.value="",p.style.cursor="pointer",p.style.opacity="1",c.value="",u.style.marginLeft="",u.textContent="Verify OTP",alert("Failed to add email due to internal server error. Please try again.")):(p.disabled=!1,p.style.cursor="pointer",p.style.opacity="1",l.value="",p.textContent="Verify OTP",alert("Failed to add email. Please try again."))}))):alert("Please enter OTP.")}))}else alert("Please enter a valid email address.");function f(){h.disabled=!0,d.remove(),h.remove(),C.remove(),r.appendChild(c),r.appendChild(u),u.textContent="Verify",u.style.cursor="pointer",u.style.opacity="1"}}))}}))}function n(e,t){const n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),d=document.createElement("p"),i=document.createElement("hr"),l=document.createElement("hr"),r=document.createElement("hr"),c=document.createElement("div"),s=document.createElement("img"),u=document.createElement("div"),m=document.createElement("p"),p=document.createElement("p"),h=document.createElement("div"),y=document.createElement("p"),C=document.createElement("p"),g=document.createElement("div"),f=document.createElement("p"),v=document.createElement("p"),b=document.createElement("div"),E=document.createElement("p"),k=document.createElement("p"),x=document.createElement("div"),w=document.createElement("a"),S=document.createElement("div"),L=document.createElement("button"),T=document.createElement("a"),P=document.createElement("div"),I=document.createElement("img"),M=document.createElement("img");if(t){let e=t.querySelector(".feed-identity-module__member-photo.EntityPhoto-circle-5.evi-image.lazy-image.ember-view");e&&(e=e.getAttribute("src")),e&&null!==e||(e=t.querySelector(".profile-card-profile-picture.evi-image.lazy-image.ember-view").getAttribute("src"));let n=t.querySelector(".feed-identity-module__member-bg-image");n&&null!==n||(n=t.querySelector(".profile-card-background-image.profile-card-background-image--default"));const o=getComputedStyle(n).backgroundImage.match(/url\(['"]?(.*?)['"]?\)/),a=o?o[1]:null;M.src=a,M.id="user-background-image",I.id="user-profile-photo",I.src=e}P.id="dashboard-email-div",d.id="emailExists",x.id="footer",s.id="refresh",a.id="header",w.id="moreCredits",T.id="help",L.id="share",S.id="shareHelpdiv",f.id="userPlanlabel",E.id="userOrganizationLabel",k.id="userOrganizationValue",u.id="userCreditsdiv",m.id="userCreditslabel",p.id="userCreditsvalue",h.id="userTotalCreditsdiv",y.id="userTotalCreditslabel",C.id="userTotalCreditsvalue",v.id="userPlanvalue",n.id="linkedAI-dashboard",g.id="userPlandiv",b.id="userOrganizationDiv",i.id="horizontalLine",l.id="horizontalLine2",r.id="horizontalLine3",o.id="dashboard-container",n.innerText="EngageGPT Dashboard";const A=e.name.split(" ").slice(0,2).join(" ");c.textContent=`${A}`,c.style.fontWeight="600",m.textContent="Credits left for today",p.textContent=`${e.credits}`,y.textContent="Total credits used (Lifetime)",C.textContent=`${e.totalCreditsUsed}`,f.textContent="Current plan","FREE"===e.plan.toUpperCase()&&(v.textContent=`${e.plan.toUpperCase()} (100 Credits/Day)`),E.textContent="Organization",k.textContent="Personal Acc.",d.textContent=`${e.email}`,P.appendChild(d),P.appendChild(w),P.style.justifyContent="center",P.style.flexDirection="column",T.href="https://chat.whatsapp.com/CxMeAkMmAlnBJzVg89hkST",T.target="_black",T.textContent="Join Community",L.textContent="Share",w.textContent="Need more credits? Click Here",w.href="https://forms.gle/dvChonHPiJS1Agez9",w.target="_blank",s.src="https://visualpharm.com/assets/32/Refresh-595b40b65ba036ed117d22db.svg",s.title="Refresh Credits",a.appendChild(c),a.appendChild(s),S.appendChild(T),S.appendChild(L),u.appendChild(m),u.appendChild(p),h.appendChild(y),h.appendChild(C),g.appendChild(f),g.appendChild(v),b.appendChild(E),b.appendChild(k),x.appendChild(r),x.appendChild(P),x.appendChild(l),x.appendChild(S),o.appendChild(M),o.appendChild(I),o.appendChild(a),o.appendChild(i),o.appendChild(u),o.appendChild(h),o.appendChild(b),o.appendChild(g),o.appendChild(x);const q=document.querySelector('[role="region"][aria-label="Side Bar"]');q.parentNode.insertBefore(o,q),L.addEventListener("click",(async function(){await navigator.clipboard.writeText("https://chromewebstore.google.com/detail/engagegpt/ldhdipkofibjleihomflebfklhadikio?hl=en-GB"),alert("Link copied to clipboard")})),s.addEventListener("click",(async function(){s.style.transform="rotate(360deg)",setTimeout((()=>{s.style.transform="rotate(0deg)",async function(){const e=document.getElementById("server-status"),t=(await new Promise((e=>{chrome.storage.local.get("jwtToken",(t=>{e(t)}))}))).jwtToken;t?chrome.runtime.sendMessage({action:"checkAuthentication"},(function(t){if(t&&t.authenticated){const e=document.getElementById("server-status");!function(e,t){const n=document.getElementById("userCreditsvalue");document.getElementById("userTotalCreditsvalue").textContent=t;const o=parseInt(n.textContent,10),a=performance.now();requestAnimationFrame((function t(d){const i=Math.min(1,(d-a)/1e3),l=Math.round(o-(o-e)*i);n.textContent=l,i<1&&requestAnimationFrame(t)}))}(t.data.user.credits,t.data.user.totalCreditsUsed),0===t.data.user.credits&&(e.textContent="Credits Exhausted",e.style.backgroundColor="red")}else e.textContent="Error Updating Credits",e.style.backgroundColor="red"})):t&&void 0!==t||(e.textContent="User not authenticated",e.style.backgroundColor="red")}()}),500)}))}function o(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("p"),o=document.createElement("a"),a=document.createElement("a"),d=document.createElement("a"),i=document.createElement("a"),l=document.createElement("a"),r=document.createElement("a"),c=document.createElement("a"),s=document.createElement("a"),u=document.createElement("img");e.id="guide-container",t.id="guide-header-div",n.id="features-title",o.id="guide-header-comment",a.id="guide-header-post",d.id="guide-header-note",i.id="guide-header-message",l.id="guide-header-message-reply",r.id="guide-header-leaderboard",c.id="guide-header-days-active",s.id="guide-header-post-collections",u.id="close",n.textContent="Features Tutorials",o.textContent="Generate Comments",o.href="https://www.youtube.com/watch?v=8K7xou2gUk4&t=11s",o.target="_blank",a.textContent="Generate Post Content",a.href="https://www.youtube.com/watch?v=rw-QI7jKVh0&t=17s",a.target="_blank",d.textContent="Add Custom Connection Note",d.href="https://www.youtube.com/watch?v=6BEvIJZdUeU",d.target="_blank",i.textContent="Generate Message Templates",i.href="https://www.youtube.com/watch?v=cfCRBYtAzFw&t=11s",i.target="_blank",l.textContent="Generate Replies to Messages",l.href="https://www.youtube.com/watch?v=cfCRBYtAzFw&t=11s",l.target="_blank",r.textContent="View Leaderboard & Profiles",r.href="",c.textContent="Tracks Active Days on LinkedIn",c.href="https://www.youtube.com/watch?v=Vja1vuFa1U4",c.target="_blank",s.textContent="Create Custom Post Collections",s.href="https://www.youtube.com/watch?v=KMcnyESy_MY",s.target="_blank",u.src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-close-1024.png",e.appendChild(u),t.appendChild(n),e.appendChild(t),e.appendChild(o),e.appendChild(a),e.appendChild(i),e.appendChild(l),e.appendChild(d),e.appendChild(c),e.appendChild(s);const m=document.querySelector('[role="region"][aria-label="Side Bar"]');m.parentNode.insertBefore(e,m),u.addEventListener("click",(function(){e.style.display="none"}))}async function a(e){const t=document.querySelector('[aria-label="LinkedIn News"]'),n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),y=document.createElement("div"),C=document.createElement("div"),g=document.createElement("label"),f=document.createElement("img"),v=document.createElement("p"),b=document.createElement("p"),E=document.createElement("p"),k=l("comments-checkbox","commentTasks"),x=l("like-checkbox","likeTasks"),w=l("post-checkbox","postTasks"),S=l("connection-request-checkbox","connectionRequest"),L=r("like-checkbox","Liked some Posts*"),T=r("post-checkbox","Posted on LinkedIn (Optional)"),P=r("connection-request-checkbox","Sent Connection Requests*"),I=r("comments-checkbox","Commented on Posts*");o.id="daily-targets-dashboard",a.id="daily-targets-header",v.id="user-streak",y.id="daily-target-header",b.id="active-days",E.id="streak-note",n.id="daily-target-checkboxes",C.id="custom-daily-targets",g.id="custom-daily-targets-label",f.id="custom-daily-targets-lock-icon",g.textContent="Customize Daily Targets",f.src="https://cdn-icons-png.flaticon.com/128/483/483408.png",a.textContent="Daily Targets";let M=e.currentStreak;v.textContent=null===M?"Current Streak : 0":`Current Streak : ${e.currentStreak}`,b.textContent=`Days Active : ${e.daysActive}`,E.textContent="Complete all daily targets to maintain your streak",localStorage.setItem("activeDays",e.daysActive),localStorage.setItem("streakCounter",e.currentStreak),await async function(e,t,n){const o=n,a=localStorage.getItem("commentTasks"),d=localStorage.getItem("likeTasks"),i=(localStorage.getItem("postTasks"),localStorage.getItem("connectionRequest")),l=new Date;if(o){const n=new Date(o);if(l.getFullYear()>n.getFullYear()||l.getMonth()>n.getMonth()||l.getDate()>n.getDate()){let n=parseInt(localStorage.getItem("activeDays")),o=parseInt(localStorage.getItem("streakCounter"));n++,chrome.runtime.sendMessage({action:"updateActiveDays",daysActive:n,currentStreak:o},(async function(l){l&&l.success?(e.textContent=`Days Active: ${l.data.user.daysActive}`,"true"===a&&"true"===d&&"true"===i?(o++,chrome.runtime.sendMessage({action:"updateActiveDays",daysActive:n,currentStreak:o},(async function(e){e&&e.success?(localStorage.setItem("streakCounter",e.data.user.currentStreak),t.textContent=`Current Streak: ${e.data.user.currentStreak}`):t.textContent=`Current Streak: ${o}`}))):(o=0,chrome.runtime.sendMessage({action:"updateActiveDays",daysActive:n,currentStreak:o},(async function(e){e&&e.success?(localStorage.setItem("streakCounter",o),t.textContent=`Current Streak: ${e.data.user.currentStreak}`):(localStorage.setItem("streakCounter",0),t.textContent=`Current Streak: ${o}`)})))):e.textContent=`Days Active: ${localStorage.getItem("activeDays")}`}))}}else localStorage.setItem("streakCounter",0)}(b,v,e.lastActive),k.checked=d("commentTasks",e.lastActive),x.checked=d("likeTasks",e.lastActive),w.checked=d("postTasks",e.lastActive),S.checked=d("connectionRequest",e.lastActive),C.appendChild(g),C.appendChild(f),function(e){const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()],n=document.createElement("div");n.id="best-timing-div";const o=document.createElement("p");o.id="best-timing-element",o.textContent=`Best Posting Time for today: ${{Monday:"11 AM",Tuesday:"6 AM to 8 AM",Wednesday:"12 PM",Thursday:"2 PM",Friday:"8 AM",Saturday:"4 AM to 5 AM",Sunday:"6 PM"}[t]}`;const a=document.createElement("p");a.id="notify-heading";const d=document.createElement("div");d.id="notify-email-div";const i=document.createElement("button");i.textContent="Notify Me",i.id="notify-button";const l=document.createElement("p");if(l.id="notify-user-email",e.email)l.textContent=`${e.email}`,d.appendChild(l),a.remove(),a.textContent="We'll notify you everyday to post";else{const e=document.createElement("input");e.type="email",e.id="notify-email-input",e.placeholder="Enter your email",d.appendChild(e),d.appendChild(i),a.textContent="Notify you everyday to post?",i.addEventListener("click",(function(){const t=e.value.trim();if(t)return t.endsWith("@gmail.com")?(i.textContent="Adding..",void chrome.runtime.sendMessage({action:"addEmail",email:t},(function(n){n&&n.success?(e.remove(),i.remove(),d.appendChild(l),l.textContent=n.data.email,a.textContent="We'll notify you everyday to post",alert(`Notification will be sent to ${t}`),alert("50 Free credits added to your account")):n.alreadyexists?(e.remove(),i.remove(),d.appendChild(l),l.textContent=n.email,a.textContent="We'll notify you everyday to post",alert("Email already exists for this account")):(e.value="",i.textContent="Notify Me",alert("Failed to add email. Please try again."))}))):(alert("Currently Gmail addresses are supported."),void(e.value=""));alert("Please enter a valid email address.")}))}n.appendChild(o),n.appendChild(a),n.appendChild(d)}(e);const A=function(e){const t=document.querySelector("#leaderboard-details-div"),n=document.querySelector("#leaderboard-header");t&&t.remove(),n&&n.remove();const o=document.createElement("div"),a=document.createElement("button"),d=document.createElement("div");return o.id="leaderboard",d.id="leaderboard-header",a.id="get-leaderBoard-button",a.textContent="View Leaderboard",d.style.justifyContent="center",d.appendChild(a),o.appendChild(d),a.addEventListener("click",(function t(){a.style.cursor="default",a.style.border="none",a.style.fontSize="14px",o.style.border="0.3px solid lightgrey",d.style.backgroundColor="white",function(e,t,n,o){const a=document.createElement("div");a.id="leaderboard-details-div";const d=document.createElement("img");d.src="https://visualpharm.com/assets/32/Refresh-595b40b65ba036ed117d22db.svg",d.title="Reload Leaderboard Data",d.id="reload-leaderboard",d.alt="Reload Leaderboard";const i=document.createElement("p");i.textContent="Top 20 EngageGPT Users",i.id="top-users-heading",i.style.margin="12px 0px 8px 0px",i.style.fontSize="14px";const l=document.createElement("img");l.src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-close-1024.png",l.title="Remove Leaderboard",l.id="remove-leaderboard-btn",l.style.display="none";const r=function(e,t,n,o,a,d){const i=document.createElement("div"),l=document.createElement("p"),r=document.createElement("label"),c=document.createElement("input"),u=document.createElement("span");return c.type="checkbox",!0===o.leaderBoardProfileVisibility?c.checked=!0:c.checked=!1,r.id="Profile-Visibility",l.classList.add("toggle-button-function"),i.classList.add("toggle-button-div"),r.classList.add("switch"),c.classList.add("toggle"),u.classList.add("slider"),u.classList.add("round"),l.textContent="Profile Visibilty",r.appendChild(c),r.appendChild(u),i.appendChild(l),i.appendChild(r),c.addEventListener("change",(function(){const t=c.checked;chrome.runtime.sendMessage({action:"updateProfileVisibility",profileVisibility:t},(async function(t){t&&t.success?s(e,n):t.error?alert("Too many Requests!! Try again after some time"):(alert("Error updating profile visibility"),c.checked=o.leaderBoardProfileVisibility)}))})),i}(a,0,e,o);e.textContent="Fetching...",d.addEventListener("click",(function(){d.style.transform="rotate(360deg)",setTimeout((()=>{d.style.transform="rotate(0deg)",s(a,e)}),500)})),chrome.runtime.sendMessage({action:"addLeaderboard"},(async function(o){if(o&&o.success){n.appendChild(d),n.appendChild(l),a.appendChild(r),a.appendChild(i),t.appendChild(a),n.style.justifyContent="space-between",e.textContent="Leaderboard",e.style.marginBottom="6px",e.style.backgroundColor="#f4f2ee",e.style.color="#0a66c2",e.style.cursor="default",e.style.fontWeight="600";const s=o.data.users,m=o.data.user,p=o.data.rank;c=s,u(a,c,m,"activeDaysSort",p),e.onclick=null}else e.style.backgroundColor="red",e.style.color="white",e.style.fontSize="12px",e.textContent="Error fetching data, Reload and try again!!",e.onclick=null,e.style.fontWeight=600,e.style.cursor="default",e.onclick=null}))}(a,o,d,e),a.removeEventListener("click",t)})),o}(e),q=function(){const e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("button"),o=document.createElement("button");return e.id="collections-container",t.id="collection-div",n.id="browse-collection-button",o.id="add-to-collection-button",n.textContent="My Collections",o.textContent="Add New Post",o.addEventListener("click",(function(){const t=document.getElementById("browse-collection-dropdown"),a=document.getElementById("new-collection-post-div"),d=document.getElementById("fetching-loader"),i=document.getElementById("posts-list"),l=document.querySelector(".delete-collection-btn");d&&d.remove(),t&&t.remove(),i&&i.remove(),l&&l.remove(),o.style.backgroundColor="#f4f2ee",o.style.color="#0077b5",o.style.border="0.8px solid #f4f2",o.style.fontWeight="600",n.style.backgroundColor="white",n.style.color="black",n.style.border="0.6px solid #0077b5",n.style.fontWeight="400",e.style.paddingTop="8px",e.style.paddingBottom="15px",a||async function(e){const t=document.createElement("div");t.id="existing-plus-newcollection-div",t.style.justifyContent="center";const n=document.createElement("div");n.id="new-post-form-div",document.createElement("p").textContent="or";const o=document.createElement("div");o.id="new-collection-post-div";const a=document.createElement("button");a.id="add-new-collection",a.style.cursor="default",a.textContent="Fetching your collections...",a.style.backgroundColor="#f4f2ee",a.style.color="#0077b5",a.classList.add("fetching-animation");const d=document.createElement("input");d.id="collection-post-url",d.placeholder="Post URL",d.required=!0;const i=document.createElement("input");i.id="collection-post-description",i.placeholder="Description",i.required=!0;const l=document.createElement("button");l.id="save-post-to-collection",l.textContent="Save",t.appendChild(a),function(e,t){chrome.runtime.sendMessage({action:"getUserCollections"},(async function(n){if(n&&n.success)if(n.data.collections&&n.data.collections.length>0){m=n.data.collections.length;const o=document.createElement("select"),a=document.createElement("p");a.id="collections-options-p",a.textContent="or",o.id="collectionDropdown";const d=document.createElement("option");d.value="",d.textContent="Choose Collection",d.disabled=!0,d.selected=!0,o.appendChild(d),n.data.collections.forEach((e=>{const t=document.createElement("option");t.value=e._id,t.textContent=e.name,o.appendChild(t),p.set(e._id,e.posts.length)})),t.classList.remove("fetching-animation"),e.style.justifyContent="space-between",t.style.backgroundColor="#0077b5",t.style.color="white",t.textContent="New Collection",t.style.cursor="pointer",t.addEventListener("click",(function(){h(e,t)})),e.appendChild(a),e.appendChild(o)}else t.textContent="New Collection",t.style.cursor="pointer",t.style.backgroundColor="#0077b5",e.style.justifyContent="space-between",t.style.color="white",t.addEventListener("click",(function(){h(e,t)})),alert("No collections found!! Create a new Collection");else 0==n.authenticated?alert("User not authenticated. Reload and try again!!"):(t.addEventListener("click",(function(){h(e,t)})),t.textContent="New Collection",t.style.cursor="pointer",t.style.backgroundColor="#0077b5",e.style.justifyContent="space-between",t.style.color="white",alert("Error getting saved collections!!"))}))}(t,a),n.appendChild(d),n.appendChild(i),n.appendChild(l),o.appendChild(t),o.appendChild(n),e.appendChild(o),l.addEventListener("click",(function(){const e=document.getElementById("collectionDropdown"),t=e?e.value:null,n=document.getElementById("new-collection-name"),o=n?n.value:null,a=d.value,r=i.value;if(!t&&!o)return void alert("Please select a collection or enter a new collection name.");if(!a)return void alert("Please enter the post URL.");if(!r)return void alert("Please enter the post description.");const c=a.split("?")[0];c.startsWith("https://www.linkedin.com/posts/")?o&&m>=10?alert("Maximum number of collections (10) reached."):t&&p.has(t)&&p.get(t)>=10?alert("Maximum number of posts (10) reached for the selected collection."):(l.textContent="Adding...",async function(e,t,n,o,a){chrome.runtime.sendMessage({action:"addToUserCollections",collectionId:e,collectionName:t,postURL:n,postDescription:o},(async function(e){e&&e.success?(a.textContent="Save",alert("Post Added to Collection"),function(e){let t=e.posts.length;p.set(e._id,t)}(e.data.collection)):(a.textContent="Save",alert("Error Adding Your Post"))}))}(t,o,c,r,l),e&&(e.selectedIndex=0),n&&(n.value=""),d.value="",i.value=""):alert("Invalid LinkedIn post URL.")}))}(e)})),n.addEventListener("click",(function(){const t=document.getElementById("fetching-loader");if(t)return void t.remove();const a=document.getElementById("new-collection-post-div"),d=document.getElementById("browse-collection-dropdown");if(d)return;a&&a.remove();const i=document.createElement("p");i.textContent="Fetching Collections...",i.id="fetching-loader",e.appendChild(i),n.style.backgroundColor="#f4f2ee",n.style.color="#0077b5",n.style.border="0.8px solid #f4f2",n.style.fontWeight="600",o.style.backgroundColor="white",o.style.color="black",o.style.border="0.8px solid #0077b5",o.style.fontWeight="400",e.style.paddingTop="8px",e.style.paddingBottom="15px";const l=document.getElementById("new-collection-post-div");l&&l.remove(),d||function(e,t){chrome.runtime.sendMessage({action:"getUserCollections"},(async function(n){if(n&&n.success)if(n.data.collections&&n.data.collections.length>0){t.remove();const o=document.createElement("select");o.id="browse-collection-dropdown";const a=document.createElement("option");a.value="",a.textContent="Choose Collection",a.disabled=!0,a.selected=!0,o.appendChild(a),n.data.collections.forEach((e=>{const t=document.createElement("option");t.value=e._id,t.textContent=e.name,o.appendChild(t)})),o.addEventListener("change",(async function(){const t=o.value;if(t){const o=document.getElementById("posts-list");o&&o.remove();const a=n.data.collections.find((e=>e._id===t)).posts;if(a.length>0){const n=document.createElement("div");n.id="posts-list",a.forEach((e=>{const o=document.createElement("div");o.classList.add("collection-posts-list");const a=document.createElement("a");var d;a.href=e.url,a.textContent=(d=e.description).length>40?d.substring(0,40)+"...":d,a.title=e.description,a.target="_blank",a.id="collection-post-urls",o.appendChild(a);const i=document.createElement("span");i.id="time-ago-span",i.textContent=function(e){const t=new Date(e),n=new Date-t,o=Math.floor(n/1e3),a=Math.floor(o/60),d=Math.floor(a/60),i=Math.floor(d/24),l=Math.floor(i/30);return l>0?1===l?"1 month ago":`${l} months ago`:i>0?1===i?"1 day ago":`${i} days ago`:d>0?1===d?"1 hour ago":`${d} hours ago`:a>0?1===a?"1 minute ago":`${a} minutes ago`:"Just now"}(e.dateAdded),n.appendChild(o);const l=document.createElement("img");l.src="https://cdn.iconscout.com/icon/premium/png-256-thumb/delete-3141467-2612798.png?f=webp",l.alt="Delete Post",l.style.width="15px",l.style.height="15px",l.style.opacity=".7",l.style.cursor="pointer",l.addEventListener("click",(function(){!async function(e,t){confirm("Are you sure you want to delete this post?")&&chrome.runtime.sendMessage({action:"deletePostFromCollection",collectionId:e,postId:t},(async function(e){e&&e.success?alert("Post deleted successfully"):alert("Error deleting the post")}))}(t,e._id)})),o.appendChild(l)})),e.appendChild(n);const o=e.querySelector(".delete-collection-btn");o&&o.remove();const d=document.createElement("button");d.classList.add("delete-collection-btn"),d.textContent="Delete Collection",d.addEventListener("click",(function(){!async function(e){confirm("Are you sure you want to delete this collection?")&&chrome.runtime.sendMessage({action:"deleteCollection",collectionId:e},(async function(t){t&&t.success?(function(e){const t=document.querySelector(".delete-collection-btn");t&&t.remove();const n=document.querySelector("#posts-list");n&&n.remove();const o=document.getElementById("browse-collection-dropdown");if(o){const t=o.querySelector(`option[value="${e}"]`);t&&t.remove()}}(e),alert("Collection deleted successfully")):alert("Error deleting the collection")}))}(t)})),e.appendChild(d)}else alert("No posts found for this collection.")}})),document.querySelector("#new-post-form-div")||e.appendChild(o)}else t.textContent="No collections found!! Create a new collection",t.style.backgroundColor="red",t.style.color="white";else 0==n.authenticated?(t.textContent="User not authenticated. Reload and try again!!",t.style.backgroundColor="red",t.style.color="white"):(t.textContent="Error getting your saved Collections!!",t.style.backgroundColor="red",t.style.color="white")}))}(e,i)})),t.appendChild(n),t.appendChild(o),e.appendChild(t),e}();y.appendChild(b),y.appendChild(v),o.appendChild(y),n.appendChild(a),n.appendChild(E),n.appendChild(x),n.appendChild(L),n.appendChild(k),n.appendChild(I),n.appendChild(S),n.appendChild(P),n.appendChild(w),n.appendChild(T),o.appendChild(n),o.appendChild(q),o.appendChild(A),t.insertBefore(o,t.firstChild),k.addEventListener("change",(()=>{k.checked?i("commentTasks",!0):i("commentTasks",!1)})),x.addEventListener("change",(()=>{x.checked?i("likeTasks",!0):i("likeTasks",!1)})),w.addEventListener("change",(()=>{w.checked?i("postTasks",!0):i("postTasks",!1)})),S.addEventListener("change",(()=>{S.checked?i("connectionRequest",!0):i("connectionRequest",!1)}))}function d(e,t){return function(e){const t=e,n=new Date;if(t){const e=new Date(t);(n.getFullYear()>e.getFullYear()||n.getMonth()>e.getMonth()||n.getDate()>e.getDate())&&(localStorage.setItem("lastVisitDate",n.toISOString()),i("commentTasks",!1),i("likeTasks",!1),i("postTasks",!1),i("connectionRequest",!1))}else localStorage.setItem("lastVisitDate",n.toISOString())}(t),"true"===localStorage.getItem(e)}function i(e,t){localStorage.setItem(e,t)}function l(e,t){const n=document.createElement("input");return n.type="checkbox",n.id=e,n.name=t,n}function r(e,t){const n=document.createElement("label");return n.htmlFor=e,n.textContent=t,n}setTimeout(e,5e3),chrome.runtime.onMessage.addListener((function(t,n,o){if("callAddDashboardFunction"===t.action){const t=document.querySelector("#linkedAI-dashboard"),n=document.querySelector("#server-status");t||n||e()}}));let c=[];function s(e,t){const n=document.querySelector(".leaderboard-list");n&&n.remove(),alert("Updating Leaderboard Data"),t.textContent="Updating...",t.style.marginBottom="6px",t.style.backgroundColor="#f4f2ee",t.style.color="#0a66c2",t.style.fontSize="14px",t.style.cursor="default",t.style.fontWeight="600",chrome.runtime.sendMessage({action:"addLeaderboard"},(async function(n){if(n&&n.success){t.textContent="Leaderboard";const o=n.data.users,a=n.data.user,d=n.data.rank;c=o,u(e,o,a,"activeDaysSort",d)}else t.style.backgroundColor="red",t.style.color="white",t.style.fontSize="12px",t.textContent="Error fetching data, Try again!!",t.style.fontWeight=600,t.style.cursor="default",t.onclick=null}))}async function u(e,t,n,o,a){const d=document.querySelector(".leaderboard-list");if(d&&d.remove(),"visibleProfiles"==o){const e=await t.filter((e=>e.leaderBoardProfileVisibility));t=e}else"AllProfiles"==o&&(t=c);t.find((e=>e.name===n.name&&e.daysActive===n.daysActive))||t.unshift(n);const i=document.createElement("div");i.classList.add("leaderboard-list"),t.forEach(((e,o)=>{const d=document.createElement("div");let l=document.createElement("div"),r=document.createElement("div"),c=document.createElement("span"),s=document.createElement("p"),u=document.createElement("p"),m=document.createElement("a");c.classList.add("serial-number"),s.classList.add("leaderboard-username"),u.classList.add("leaderboard-user-active-days"),l.classList.add("leaderboard-right-div"),r.classList.add("leaderboard-left-div"),d.classList.add("leaderboard-list-items"),m.classList.add("leaderboard-profile-link"),e.profileLink&&(m.href=e.profileLink),m.target="_blank",m.rel="noopener noreferrer",m.textContent="View Profile";let p=e.name.split(" ")[0];s.textContent=p,s.style.fontWeight=600,u.textContent=`Days Active: ${e.daysActive}`,!0===e.leaderBoardProfileVisibility&&l.appendChild(m),l.appendChild(u),r.appendChild(c),r.appendChild(s),d.appendChild(r),d.appendChild(l),21===t.length?c.textContent=o+1===1?`${a}.`:o+1===2?"🏅":o+1===3?"🥈":o+1===4?"🥉":`     ${o+1}.  `:20===t.length&&(c.textContent=o+1===1?"🏅":o+1===2?"🥈":o+1===3?"🥉":`     ${o+1}.  `),n.daysActive===e.daysActive&&e.name==n.name&&(d.style.backgroundColor="#d3efff",s.style.fontWeight=600),i.appendChild(d)})),e.appendChild(i),t.length>10&&(i.firstChild.style.marginTop=36*(t.length-10)+2*(t.length-10)+4+"px")}let m=0,p=new Map;function h(e,t){const n=document.querySelector("#collectionDropdown"),o=document.querySelector("#collections-options-p");t.remove(),n&&n.remove(),o&&o.remove();const a=document.createElement("input");a.id="new-collection-name",a.placeholder="Enter Collection Name",a.required=!0,e.appendChild(a)}})();